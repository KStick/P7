<!DOCTYPE html>
<html>
<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	<script src="videoWorker.js" type="text/javascript"></script>
	<script src="WSVideoStream.js" type="text/javascript"></script>
	<title>JSMpeg Stream Client</title>
	<style type="text/css">
		html, body {
			background-color: #111;
			text-align: center;
		}
	</style>
	
</head>
<body>
	<input type="hidden" id="videoWSURL" value="ws://localhost:8080/websocket"></input>
	<video autoplay="true" id="videoElement" width="320" height="240"> </video>
	<script type="text/javascript">
		$(document).ready(function(){
		var video = document.getElementById('videoElement');
		var wsVIDEO = document.getElementById("videoWSURL").value.toString();
 
		navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia;
		 
		if (navigator.getUserMedia) {       
		    navigator.getUserMedia({video: true}, handleVideo, videoError);
		}
		 
		function handleVideo(stream) {
		    video.src = window.URL.createObjectURL(stream);
		    localVideoRec = new WSVideoStream(stream, wsVIDEO, 'video-protocol');
      		setTimeout(function () { localVideoRec.record(); }, 500);
		}
		 
		function videoError(e) {
		    Console.log(e);
		}
	})
	</script>
</body>
</html>